!function(){angular.module("ued",["ngRoute","ngCookies"]),angular.element(document).ready(function(){angular.bootstrap(document,["ued"])})}(),function(){var e=["index"];angular.module("ued").config(["$routeProvider",function(n){e.forEach(function(e){n.when("/"+e,{controller:e,controllerAs:e,templateUrl:"page/"+e+"/"+e+".html"})}),n.otherwise({redirectTo:"/index"})}])}(),function(){angular.module("ued").controller("index",["$scope","uCreatejs",function(e,n){function t(){n.load({selector:"canvas",name:"h5",path:"flash/h5",spritesheetLength:12,spritesheetName:"h5_atlas_",onProgress:function(e){},onComplete:function(e){exportRoot=e.exportRoot,o(exportRoot),i||$("#canvas").one("touchstart",function(){$("#music")[0].play()})}})}function o(e){var n=[exportRoot.instance_12,exportRoot.instance_11,exportRoot.instance_10,exportRoot.instance_9,exportRoot.instance_8,exportRoot.instance_7,exportRoot.instance_6,exportRoot.instance_5,exportRoot.instance_4,exportRoot.instance_3,exportRoot.instance_2,exportRoot.instance_1];e.addChild(n[0]);new Swipe(document.getElementById("container"),{continuous:!1,stopPropagation:!0,callback:function(t){e.removeAllChildren(),setTimeout(function(){$("#canvas").appendTo($("#container ul li:eq("+t+")")),e.addChild(n[t]),n[t].gotoAndPlay(0)},500)}})}e.$on("$viewContentLoaded",t);var i=!0;document.addEventListener("WeixinJSBridgeReady",function(){$("#music")[0].play()},!1),e.playPause=function(){$(".btn_music").toggleClass("music_off"),i?$("#music")[0].pause():$("#music")[0].play(),i=!i}}])}(),function(){angular.module("ued").directive("uAfterRender",["$timeout",function(e){return{restrict:"A",link:function(n,t,o){n.$watch(function(){n.$eval(o.ngBindHtml)},function(i){e(function(){n.$eval(o.uAfterRender,{$element:t})})})}}}])}(),function(){angular.module("ued").directive("uApp",["uBaidu","uBrowser","uWeixin",function(e,n,t){return{replace:!0,templateUrl:"component/uApp/uApp.html",link:function(e,t,o){function i(n,t,o){t.$$route&&(e.ctrlName=t.$$route.controllerAs),$("body :not([ng-view],link,script)").remove()}function r(){n.setTitle("珍藏最好时光 记录长期陪伴")}function a(e,n){}FastClick.attach(document.body),e.$on("$routeChangeStart",i),e.$on("$viewContentLoaded",r),n.onOrientationChange(a)}}}])}(),function(){angular.module("ued").filter("uHtml",["$sce",function(e){return function(n){return e.trustAsHtml(n)}}])}(),function(){angular.module("ued").factory("uBaidu",function(){var e={};return e.trackEvent=function(e,n){window._hmt&&_hmt.push(["_trackEvent",e,n||"click",e])},e.trackPageView=function(e){window._hmt&&_hmt.push(["_trackPageview",e])},e})}(),function(){angular.module("ued").factory("uBrowser",function(){var e={};return e.isWeixin=function(){return/MicroMessenger/i.test(navigator.userAgent)},e.isAndroid=function(){return/Android/i.test(navigator.userAgent)},e.isIOS=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},e.isMobile=function(){return/Android|BlackBerry|iPhone|iPad|iPod|IEMobile/i.test(navigator.userAgent)},e.onOrientationChange=function(e){function n(){var n=window.orientation;n&&e(n,90===Math.abs(n))}"function"==typeof e&&(window.removeEventListener("orientationchange",n),window.addEventListener("orientationchange",n))},e.setTitle=function(n){if(document.title=n,e.isWeixin())var t=$('<iframe style="display: none;" src="/favicon.ico"></iframe>').on("load",function(){setTimeout(function(){t.off("load").remove()},0)}).appendTo("body")},e})}(),function(){angular.module("ued").factory("uCreatejs",function(){function e(e,n){var t=document.createElement("script");t.type="text/javascript",t.onload=n,t.src=e,document.querySelector("head").appendChild(t)}function n(e){function n(){u=$(e.selector)[0],images=images||{},ss=ss||{},t(function(n){lib.properties.manifest=lib.properties.manifest.map(function(n){return n.src=e.path+"/"+n.src,n}),n=n.concat(lib.properties.manifest),i(n,e.onProgress,a)})}function t(n){for(var t=[],i=e.spritesheetLength,r=1;r<=e.spritesheetLength;r++){var a=e.spritesheetName+(1==r?"":r),u=e.path+"/images/"+a+".json";!function(e,r){o(r,function(o){ss[e]=new createjs.SpriteSheet(o),o.images.forEach(function(n){t.push({id:e,src:n,isSpritesheet:!0})}),0==--i&&n(t)})}(a,u)}}function o(n,t){$.getJSON(n,function(n){n.images=n.images.map(function(n){return n=e.path+"/"+n}),t(n)})}function i(e,n,t){var o=0;e.forEach(function(i){r(i.src,function(r){i.isSpritesheet||(images[i.id]=r),o++,n&&n(o/e.length),o==e.length&&t()})})}function r(e,n){var t=new Image;t.onload=function(){n(t)},t.src=e}function a(){s=new lib[e.name],c=new createjs.Stage(u),c.addChild(s),c.update(),createjs.Ticker.setFPS(lib.properties.fps),createjs.Ticker.addEventListener("tick",c),e.onComplete&&e.onComplete({lib:lib,ss:ss,stage:c,exportRoot:s,images:images})}var u,c,s;n()}return{load:function(t){e(t.path+"/"+t.name+".js",function(){n(t)})}}})}(),function(){angular.module("ued").factory("uQuery",function(){var e={};return e.query=function(e){var n=window.location.href.split("?")[1];if(n&&n.indexOf(e)!=-1){var t=n.match(new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"));return unescape(t[2])}return""},e})}(),function(){angular.module("ued").factory("uRequest",["$timeout",function(e){var n={},t=0;return n.getCount=function(){return t},n.isLocal=function(){return/127\.0\.0\.1|localhost|192\./i.test(window.location.hostname)},n.ajax=function(o){var i=$.Deferred();return t++,n.isLocal()&&!/^http/i.test(o.url)?(o.url="mock"+o.url+".json",o.type="GET"):o.url.indexOf("http")===-1&&(o.url=window.location.origin+o.url),$.ajax(o).always(function(){t--}).then(function(n){e(function(){n.success?i.resolve(n):i.reject(n)})},function(n){e(function(){i.reject({success:!1,errorMsg:"网络繁忙,请稍候重试!"})})}),i.promise()},n.get=function(e,t){return n.ajax({type:"GET",url:e,data:t,dataType:"json"})},n.jsonp=function(e,t){return n.get(e+"?jsonpcallback=?",t)},n.post=function(e,t){return n.ajax({type:"POST",url:e,data:t,dataType:"json"})},n.upload=function(e,t){return n.ajax({type:"POST",url:e,data:t,dataType:"json",contentType:!1,processData:!1})},n}])}(),function(){angular.module("ued").factory("uValidate",function(){var e={};return e.isEmpty=function(e){return null==e||!String(e).trim()},e.isPhoneNumber=function(e){return/^\d{11}$/.test(e)},e})}(),function(){angular.module("ued").factory("uWebApi",["uRequest",function(e){var n={};return n.getUserInfo=function(n){return e.post("/campaign/htamhb/get-campaign-user-info",n)},n.doPersonalLottery=function(n){return e.post("/campaign/htamhb/lottery1",n)},n.doExclusiveLottery=function(n){return e.post("/campaign/htamhb/lottery2",n)},n}])}(),function(){angular.module("ued").factory("uWeixin",["uRequest",function(e){var n={};return n.debug=!1,n.init=function(t){n.call("hideOptionMenu");var o=$.Deferred(),i="/weixin/index/get-jsapi-ticket",r=null;return r=t?e.jsonp("http://weixinoauth.umaman.com/weixin/index/get-jssdk-info",{url:window.location.href.split("#")[0]}):e.get(i),r.then(function(e){if(t)n.config(e.result);else{var i=e.result,r=i.appid,a=i.jsapi_ticket,u=i.expire_time,c=n.getNonceStr(),s=window.location.href.split("#")[0],d=window.hex_sha1("jsapi_ticket="+a+"&noncestr="+c+"&timestamp="+u+"&url="+s),l={appId:r,timestamp:u,nonceStr:c,signature:d};n.config(l)}o.resolve()},function(){console.error("services/Weixin.init() error."),o.reject()}),o.promise()},n.config=function(e){e.debug=n.debug,e.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","translateVoice","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","closeWindow","scanQRCode"],wx.config(e)},n.call=function(e){function n(){WeixinJSBridge.call(e)}try{"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",n,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",n),document.attachEvent("onWeixinJSBridgeReady",n)):n()}catch(t){}},n.invoke=function(e,n,t){function o(){WeixinJSBridge.invoke(e,n,t)}try{"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",o,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",o),document.attachEvent("onWeixinJSBridgeReady",o)):o()}catch(i){}},n.share=function(e,n){wx.ready(function(){wx.showOptionMenu(),wx.onMenuShareAppMessage(e),wx.onMenuShareTimeline(n||e)})},n.getNonceStr=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",t=16,o=0;o<t;o++)n+=e.substr(Math.floor(Math.random()*(e.length-1)),1);return n},n.editAddress=function(e,t){n.invoke("editAddress",{appId:e.appId,scope:"jsapi_address",signType:"sha1",addrSign:e.addrSign,timeStamp:e.timeStamp,nonceStr:e.nonceStr},t)},n.chooseWXpay=function(t,o){return e.isLocal()?void("function"==typeof o&&o({err_msg:"get_brand_wcpay_request:ok"})):(t.timestamp=t.timestamp||t.timeStamp,void n.invoke("getBrandWCPayRequest",t,function(e){"function"==typeof o&&o(e)}))},n}])}();